<script setup lang="ts">
const authStore = useAuthStore()
const {user} = storeToRefs(authStore)
const {$api} = useNuxtApp()
const menu = ref();
const items = ref([
  {
    label: user.value?.full_name,
    items: [
      {
        label: 'Профиль',
        icon: 'pi pi-refresh'
      },
      {
        label: 'Выход',
        icon: 'pi pi-upload',
        command: async () => {
          await $api.auth.logout();
        }
      }
    ]
  }
]);

const toggle = (event) => {
  menu.value.toggle(event);
};
</script>
<template>
  <template v-if="user">
    <div class="flex items-center justify-end gap-6">
      <div class="relative">
        <svg width="21" height="19" viewBox="0 0 21 19" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M10.6558 18.8379C10.3945 18.9871 10.0733 18.9872 9.81207 18.8379L10.2339 18.0996L10.6558 18.8379ZM15.1089 0C17.3995 0 19.3789 1.59608 20.1343 3.8623C20.9009 6.16223 20.4132 9.09207 18.0044 11.9023C15.7274 14.559 13.9138 16.279 12.6578 17.3418C12.0298 17.8732 11.5413 18.2409 11.2037 18.4785C11.0349 18.5973 10.9039 18.6838 10.8121 18.7422C10.7662 18.7714 10.7297 18.7938 10.7037 18.8096C10.6908 18.8173 10.6804 18.8235 10.6724 18.8281C10.6686 18.8304 10.6653 18.8324 10.6627 18.834L10.6568 18.8369L10.2339 18.0996C9.84535 18.7796 9.81473 18.8339 9.81207 18.8379L9.81011 18.8359C9.80908 18.8353 9.80755 18.8348 9.80621 18.834C9.80355 18.8324 9.80029 18.8304 9.79644 18.8281C9.78843 18.8234 9.77723 18.8174 9.76422 18.8096C9.73812 18.7938 9.70173 18.7714 9.65582 18.7422C9.56401 18.6838 9.43291 18.5972 9.26422 18.4785C8.92654 18.2409 8.43807 17.8731 7.81011 17.3418C6.55406 16.279 4.7404 14.5588 2.46343 11.9023C0.0548415 9.09208 -0.432071 6.16219 0.334527 3.8623C1.08991 1.59616 3.06846 0.000108166 5.35894 0C7.63073 0 9.07703 1.37903 9.90972 2.62793C10.029 2.80691 10.1358 2.98674 10.2339 3.16113C10.3321 2.98667 10.4388 2.80698 10.5582 2.62793C11.3908 1.37902 12.8372 9.43861e-05 15.1089 0ZM15.1089 1.69922C13.6311 1.69931 12.6395 2.57033 11.9722 3.57129C11.6408 4.06844 11.409 4.57173 11.2603 4.9541C11.1865 5.14378 11.1351 5.30077 11.1021 5.40723C11.0857 5.4602 11.074 5.50088 11.0669 5.52637C11.0634 5.53909 11.0604 5.54875 11.0591 5.55371L11.0582 5.55469L11.0591 5.55566C10.9645 5.93406 10.624 6.19922 10.2339 6.19922C9.844 6.19911 9.5043 5.93398 9.40972 5.55566V5.55762L9.40191 5.52637C9.39483 5.50089 9.38318 5.46029 9.36675 5.40723C9.3338 5.30077 9.28137 5.14387 9.20757 4.9541C9.05884 4.57169 8.82708 4.06844 8.49566 3.57129C7.82832 2.57028 6.83695 1.69922 5.35894 1.69922C3.89967 1.69933 2.50394 2.72836 1.94683 4.39941C1.401 6.0369 1.66339 8.35731 3.75445 10.7969C5.97724 13.3901 7.72637 15.0453 8.90777 16.0449C9.49233 16.5396 9.93872 16.8729 10.2339 17.0811C10.5291 16.8729 10.9755 16.5396 11.5601 16.0449C12.7415 15.0453 14.4907 13.39 16.7134 10.7969C18.8045 8.35731 19.0679 6.0369 18.522 4.39941C17.9649 2.72818 16.5683 1.69922 15.1089 1.69922Z" fill="#8D95A5"/>
        </svg>
        <div class="bg-secondary absolute top-[-10px] right-[-15px] text-white w-[16px] h-[16px] inline-flex items-center justify-center rounded-full p-1 text-[10px]">3</div>
      </div>
      <div class="relative">
        <svg width="22" height="21" viewBox="0 0 22 21" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9.18009 0.0411378C10.478 -0.0229595 11.7786 -0.0121061 13.0756 0.0733643C17.5494 0.371835 21.1267 3.87711 21.6195 8.33118L21.6576 8.76575C21.6991 9.4154 21.7096 10.0822 21.6889 10.7404L21.6576 11.3947C21.3572 16.0465 17.7066 19.7688 13.0981 20.0851C13.0908 20.0857 13.0838 20.0885 13.0766 20.089C11.6114 20.1854 10.0848 20.1854 8.62247 20.089C8.0494 20.0504 7.42339 19.9143 6.87149 19.6866C6.66413 19.6016 6.51587 19.5433 6.40469 19.5011C6.33115 19.5531 6.23445 19.6223 6.10391 19.7189C5.29429 20.3158 4.27165 20.7331 2.82852 20.6984C2.54515 20.6916 2.22316 20.6866 1.96134 20.6359C1.65999 20.5774 1.27241 20.4279 1.03067 20.0138C0.767417 19.5632 0.876468 19.1101 0.973054 18.84C1.06844 18.5732 1.23603 18.2598 1.39786 17.9523C1.86675 17.0635 1.96993 16.3799 1.73868 15.9474C0.905701 14.6867 0.153518 13.1276 0.0414133 11.3956C-0.0138053 10.5209 -0.0138035 9.64248 0.0414133 8.7677C0.342311 4.10819 4.00469 0.380251 8.62344 0.0733643L9.18009 0.0411378ZM12.9633 1.76868C11.7317 1.68754 10.4965 1.67754 9.26407 1.7384L8.73575 1.76965C4.98667 2.01894 1.9848 5.04974 1.7377 8.8761C1.6871 9.67868 1.6871 10.4837 1.7377 11.2863L1.76016 11.5363C1.88113 12.6159 2.32426 13.6587 2.90665 14.6173L3.18497 15.0538L3.22208 15.1144C3.91699 16.3723 3.4029 17.7954 2.90176 18.7452L2.90079 18.7443C2.85213 18.8367 2.81052 18.9197 2.77188 18.9943C2.80257 18.995 2.83471 18.9974 2.86856 18.9982C3.9151 19.0233 4.57188 18.7357 5.09415 18.3507C5.27339 18.2181 5.43967 18.0952 5.57755 18.006C5.6914 17.9323 5.91494 17.7919 6.19083 17.7579L6.29923 17.7501C6.54784 17.7458 6.77332 17.8261 6.88223 17.8644C7.0525 17.9242 7.26994 18.0134 7.51602 18.1144L7.51798 18.1154C7.88553 18.2672 8.32954 18.3653 8.73575 18.3927C10.1187 18.4839 11.5641 18.4833 12.9506 18.3927C12.9548 18.3924 12.9591 18.392 12.9633 18.3917C16.7122 18.1435 19.7142 15.1119 19.9613 11.2853C20.012 10.4918 20.012 9.66857 19.9613 8.87512L19.9301 8.51868C19.5258 4.86303 16.5957 2.01096 12.9633 1.76868Z" fill="#8D95A5"/>
          <path d="M6.85853 9.10015L6.98645 9.10699C7.6168 9.17098 8.10853 9.70293 8.10853 10.3502C8.10853 10.9974 7.6168 11.5293 6.98645 11.5933L6.85853 11.6002H6.84974C6.15938 11.6002 5.59974 11.0405 5.59974 10.3502C5.59974 9.6598 6.15938 9.10015 6.84974 9.10015H6.85853ZM10.8546 9.10015C11.545 9.10015 12.1046 9.6598 12.1046 10.3502C12.1046 11.0405 11.545 11.6002 10.8546 11.6002H10.8449C10.1545 11.6002 9.59485 11.0405 9.59485 10.3502C9.59485 9.6598 10.1545 9.10015 10.8449 9.10015H10.8546ZM14.8497 9.10015C15.5401 9.10015 16.0997 9.6598 16.0997 10.3502C16.0997 11.0405 15.5401 11.6002 14.8497 11.6002H14.8409C14.1506 11.6002 13.5909 11.0405 13.5909 10.3502C13.5909 9.6598 14.1506 9.10015 14.8409 9.10015H14.8497Z" fill="#8D95A5"/>
        </svg>
        <div class="bg-secondary absolute top-[-10px] right-[-15px] text-white w-[16px] h-[16px] inline-flex items-center justify-center rounded-full p-1 text-[10px]">3</div>
      </div>
      <UIAvatar class="cursor-pointer" size="md" @click="toggle"/>

      <Menu ref="menu" id="overlay_menu" :model="items" :popup="true" />
    </div>
  </template>
  <template v-else>
    <UIButton @click="navigateTo('/login')" label="Вход/Регистрация"/>
  </template>
</template>

<style scoped>

</style>